---
title: "회사 Imap 확인 방법"
date: 2025-11-25
tags:
  - "ChatGPT"
url: "https://chatgpt.com/c/692553d2-6040-8321-a5ab-4e911a658834"
projectName: ""
---

## You

매일 6:30 12:30 받은 메일함을 메일 확인해서.. 
내가 수신자이거나..
메일 내용에 이재호, 또는 justin 포함되어 있으면 알림을 주는 프로그램을 만들 수 있을까?
아님 기존에 있는 프로그램을 이용할 수 있을까?
살아서 백라운드로 돌아야 해..

---

## ChatGPT

만드는 것도 가능하고, 기존 프로그램+간단한 스크립트 조합으로도 충분히 할 수 있어요 😊  
(완전 “그냥 설치만 하면 끝”인 프로그램은 조건이 좀 특이해서 거의 없고, 보통은 규칙+스크립트+스케줄러 조합으로 가게 됩니다.)

아래처럼 생각해 보면 좋아요.

---

## 1. 전체 구조 아이디어

요구사항 정리해보면:

- **매일 06:30, 12:30에만** 동작
- 받은 메일함에서
  - 내가 수신자이거나 (To, Cc에 내 메일 주소 포함)
  - 메일 **제목/본문에 “이재호” 또는 “justin”** 포함
- 해당 메일이 있으면 **알림** (팝업/토스트, 또는 요약 메일 등)
- 백그라운드로 돌 것

이걸 구현하는 전형적인 구조는:

1. **Python 스크립트 하나** 만든다.
   - 메일 서버(IMAP/Exchange/Gmail API 등)에 접속
   - “마지막 검사 시각 이후 받은 메일”만 검색
   - 조건(수신자, 내용 키워드) 맞는 메일 목록 추려서
   - OS 알림 / 요약 메일 / 로그 출력

2. **OS 스케줄러**에 등록해서 자동 실행
   - Windows → 작업 스케줄러(Task Scheduler)
   - Linux → cron
   - “06:30, 12:30에 실행”만 설정해두면 됨  
   - 실행될 때마다 잠깐 켜졌다가 끝나는 방식이라 “살아서 백그라운드로 돌아가는 것”과 비슷하게 동작

항상 상주 프로세스로 두는 것보다 **스케줄러 방식이 더 안정적**이고 관리도 쉬워요.

---

## 2. 구현 방법 (Python + IMAP 기준)

메일 서버가 IMAP을 지원한다고 가정하면 (Gmail, 대부분 회사 메일, Exchange/Outlook도 보통 옵션으로 있음):

### (1) 해야 할 일

1. Python 설치 (이미 있을 가능성 큼)
2. 라이브러리:
   ```bash
   pip install imapclient pyzmail36
   ```
3. 스크립트에서:
   - `IMAPClient`로 받은메일함 접속
   - 오늘 날짜(또는 마지막 체크 시각) 기준으로 검색
   - 수신자 필터: `TO` / `CC` 헤더에 내 메일주소 포함 여부 확인
   - 제목/본문에 `"이재호"` 또는 `"justin"` 문자열 포함 여부 확인
   - 조건 맞는 메일 있으면:
     - Windows: 토스트 알림 (예: `win10toast` 라이브러리)
     - 또는 **나 자신에게 요약 메일을 다시 보내기** (사내 정책 때문에 OS 알림이 제한적이면 이 방식도 가능)

4. 마지막 검사 시각을 `last_check.txt` 같은 파일에 저장해두고, 매번 읽고 갱신.

코드는 실제 환경(메일 서버 주소, 계정 등)에 따라 달라져서 여기서 바로 완성본 주면 위험할 수 있으니,  
원하면 **“Gmail용 버전”**, **“회사 Outlook(Exchange)용 버전”** 중 하나 골라서 제가 예제 코드 만들어 줄게요.

---

## 3. 스케줄링 (백그라운드 실행)

### Windows인 경우 (가장 유력해 보여서 이걸 기준으로 설명)

1. **Task Scheduler(작업 스케줄러)** 실행
2. “기본 작업 만들기”:
   - 이름: `메일 키워드 알림`
   - 트리거: 매일
   - 시간: 06:30
   - 다 만든 뒤 “속성”에서 **추가 트리거**로 12:30 하나 더 추가
3. 동작:
   - 프로그램: `python.exe` 경로
   - 인수: `C:\path	o\check_mail.py`
   - 시작 위치: `C:\path	o`
4. “사용자가 로그온했는지와 관계없이 실행” 체크하면,  
   로그인 안 돼 있어도 돌아가게 설정 가능 (다만 회사 정책에 따라 제한 있을 수 있음).

이렇게 하면 **완전히 자동으로 백그라운드**에서 돌아갑니다.

### Linux/서버에 두고 돌리고 싶다면

`crontab -e` 에 아래처럼:

```cron
30 6,12 * * * /usr/bin/python3 /home/user/check_mail.py
```

---

## 4. “기존 프로그램”으로만 해결할 수 있는가?

완전한 의미에서:

- “06:30, 12:30에만”
- “내가 수신자이거나 + 내용에 특정 문자열”

이렇게 **복합 조건 + 특정 시각 알림**은  
일반 메일 클라이언트(Outlook/Gmail 웹, Thunderbird)의 기본 기능만으론 애매합니다.

부분적으로:

- Outlook 규칙
  - 조건: 수신자/본문에 키워드 포함 시 카테고리/폴더로 이동, 플래그 표시 등
  - 한계: **특정 시각에만 묶어서 알려주는 기능은 없음**
- Gmail 필터 + 라벨
  - 조건에 맞는 메일에 라벨 붙이기
  - 한계: 역시 특정 시각에 요약 알림은 기본 기능엔 없음

그래서 현실적인 베스트는:

> **메일 클라이언트의 필터/라벨로 미리 표시 → Python/스크립트+스케줄러로 시간별 알림**

조합입니다.

---

## 5. 다음 단계

바로 시작하려면 제가 이렇게 도와줄 수 있어요:

1. **환경만 알려준다고 가정하고**:
   - 메일 종류: Gmail / Outlook(회사) / 기타(IMAP 지원?)  
   - OS: Windows 10/11? (거의 확실하지만 일단 가정)

2. 그에 맞는:
   - 메일 검색 Python 코드 예제
   - “이재호 / justin” 키워드 포함 필터
   - 마지막 검사 시각 관리
   - Windows 작업 스케줄러에 등록할 때 써야 할 명령줄 형태

를 한 번에 다 작성해서 드릴 수 있어요.

일단 개념만 보면 “충분히 만들 수 있고, 실제로 많이 쓰는 패턴”이라  
조금만 세팅해두면 꽤 편하게 쓸 수 있어요 🙂

---

## You

회사가 Imap인지 아닌지 어떻게 알지/

---

## ChatGPT

회사 메일이 **IMAP을 지원하는지 확인하는 방법**은 크게 5가지가 있어요.  
가장 확실한 순서대로 정리해줄게요.

---

# ✅ 1. 회사 Outlook(Office 365 / Exchange Online) 사용 중이라면  
많은 기업은 **Exchange 기반(Outlook)** 을 씁니다.  
Exchange는 IMAP을 “회사 정책에 따라 켜거나 끌 수 있는” 구조라서, **기본적으로 안 열려 있는 경우가 많습니다.**

### ✔ 확인 방법  
### (1) 회사 Outlook Web에 로그인  
주소 예)  
- https://outlook.office.com  
- https://outlook.company.com

### (2) 상단 우측 ⚙(설정) → `모든 Outlook 설정 보기`

### (3) **메일 → Sync Email(전자메일 동기화) 를 찾는다**

- 만약 아래 옵션이 보이면 IMAP/POP을 지원한다:
  ```
  POP 및 IMAP
  서버: outlook.office365.com
  IMAP: 포트 993
  ```
- **Sync Email 메뉴 자체가 없으면 → 회사가 IMAP 비활성화한 것**

---

# ✅ 2. Outlook PC 앱에서 확인하는 방법

### (1) Outlook 실행 → `파일 (File)` 메뉴  
### (2) `계정 설정(Account Settings)` → `계정 설정`  
### (3) 계정 유형 확인  
여기서 **"Microsoft Exchange"**, **"Office 365"** 로 나온다면:

```
→ 기본적으로 IMAP 미사용, 회사 정책에 따라 허용 가능성 있음.
→ 하지만 보통 외부 IMAP 접속은 막혀 있음.
```

만약 아래처럼 보이면:

```
IMAP / POP / SMTP
```

→ IMAP 지원 확정.

---

# ✅ 3. 회사 보안 정책 문서 (가장 정확)

사내 IT 보안 정책 문서 / 회사 인트라넷의 IT 가이드에 종종 아래가 명시되어 있어요:

- “IMAP/POP 외부 접속 차단”
- “외부 메일 클라이언트는 OAuth만 허용”
- “회사 계정은 Outlook 앱만 사용 가능”
- 등등

이 문서가 있으면 제일 빨라요.

---

# ✅ 4. IT Support / 헬프데스크에 문의 (가장 정확 + 가장 빠름)

그냥 이렇게 물어보면 됩니다:

> “회사 메일 계정(IMAP/POP) 외부 프로토콜 사용이 가능한가요?  
>  가능하다면 서버 주소와 포트 정보를 알려주세요.”

IMAP을 막은 회사도 많아서, IT 측에서 바로 알려줍니다.

---

# ✅ 5. 직접 테스트하는 방법(기술자용)

만약 회사 노트북에서 **telnet / openssl** 실행이 가능하면:

```bash
telnet outlook.office365.com 993
```

또는:

```bash
openssl s_client -connect outlook.office365.com:993
```

연결되면 IMAP 포트가 열려있는 것.  
연결 실패 → 회사 방화벽/정책으로 IMAP 차단.

---

# 📌 요약

| 회사 메일 상태 | IMAP 지원 여부 |
|----------------|----------------|
| Outlook / Exchange / Office 365 | **정책에 따라 다름 (많이 차단해둠)** |
| Gmail(기업용 Google Workspace) | **IMAP 기본 지원** (관리자 설정에 따라 막힐 수 있음) |
| 자체 도메인 + 보안 강한 기업 | **대부분 차단** |
| 사내에 특별한 IT 정책 없음 | **대부분 지원** |

---

# 👉 필요하면, 회사 Outlook 기준으로  
### ✦ IMAP 없이도 메일 검색/알림 기능을 만드는 방법  
### ✦ Microsoft Graph API 방식  
### ✦ Exchange EWS 방식  

으로도 만들어줄 수 있어요.  
IMAP 없어도 구현 가능하니까 걱정 안 해도 됩니다.

---

회사 메일 환경이 뭔지만 알려주면, 거기에 맞춰 **동작하는 완성 스크립트** 만들어 드릴게요!

---

## You

우리 회사는 exchange를 사용하고 있어

---

## ChatGPT

Exchange 쓰면 IMAP 없어도 충분히 가능합니다 😄  
대신 **Exchange 전용 라이브러리나 Outlook을 직접 조종**해서 해결해야 해요.

아래는 **현실적으로 제일 깔끔한 구조 하나**를 먼저 정리해 줄게요.

---

## 1. 전체 그림 (Exchange + Windows 기준)

가정:

- 회사 메일 = **Exchange (On-Prem 또는 Exchange Online)**
- PC = Windows (Outlook/VSCode 쓰시는 걸 보면 거의 확실)

구성:

1. **Python 스크립트** 하나 만듬  
   - Exchange 서버에 접속 (`exchangelib` 라이브러리 사용)
   - 받은 편지함에서 **“마지막 체크 이후 ~ 지금까지” 메일 검색**
   - 조건 필터:
     - 수신자 목록(To, Cc)에 내 메일 주소 포함  
       **또는**
     - 제목/본문에 `"이재호"` 또는 `"justin"` 포함
   - 조건 맞는 메일 있으면:
     - Windows 알림(토스트) 띄우거나
     - 콘솔/로그/팝업 등으로 알려줌

2. **Windows 작업 스케줄러(Task Scheduler)**에  
   - `06:30`, `12:30`에 이 스크립트를 실행하도록 등록
   - 스크립트는 잠깐 실행해서 검사하고 바로 종료 →  
     사용자는 “알아서 백그라운드에서 도는 것처럼” 느끼게 됨

> 항상 떠 있는 데몬 프로그램으로 만들 필요 없이,  
> **스케줄러 방식이 훨씬 안정적이고 관리도 쉽습니다.**

---

## 2. Exchange 접속: `exchangelib` 사용

### (1) 준비

1. Python 설치
2. 라이브러리 설치 (CMD/PowerShell):

```bash
pip install exchangelib win10toast
```

- `exchangelib`: Exchange 서버 접속용
- `win10toast`: Windows 알림용 (토스트)

### (2) 기본 코드 골격 예시

> ⚠ 서버 주소, 계정, 메일 주소 등은 회사 환경에 맞게 바꿔야 합니다.  
> (아래는 **구조 이해용** 예시)

```python
from datetime import datetime, timedelta, timezone
from exchangelib import DELEGATE, Account, Credentials, Configuration, Message, Q
from win10toast import ToastNotifier
import os
import json

# --- 설정값 (환경에 맞게 수정) ---
EMAIL = "your.name@company.com"      # 본인 회사 메일 주소
USERNAME = "DOMAIN\your_login_id"   # 도메인\계정  또는  your_login_id@company.com
PASSWORD = "your_password"           # 가능하면 나중에 윈도우 자격 증명 등으로 대체

EXCHANGE_SERVER = "https://mail.company.com/EWS/Exchange.asmx"  # EWS URL (IT팀에게 물어볼 것)
LAST_CHECK_FILE = "last_check.json"

KEYWORDS = ["이재호", "justin"]

# --- 마지막 검사 시각 저장/로드 ---
def load_last_check_time():
    if not os.path.exists(LAST_CHECK_FILE):
        # 없으면 12시간 전부터로 가정
        return datetime.now(timezone.utc) - timedelta(hours=12)
    with open(LAST_CHECK_FILE, "r", encoding="utf-8") as f:
        data = json.load(f)
    return datetime.fromisoformat(data["last_check"])

def save_last_check_time(dt):
    with open(LAST_CHECK_FILE, "w", encoding="utf-8") as f:
        json.dump({"last_check": dt.isoformat()}, f, ensure_ascii=False, indent=2)

# --- 토스트 알림 ---
toaster = ToastNotifier()

def notify(title, msg):
    toaster.show_toast(title, msg, duration=10, threaded=False)

def main():
    # 1) Exchange 계정 연결
    creds = Credentials(username=USERNAME, password=PASSWORD)
    config = Configuration(server=EXCHANGE_SERVER, credentials=creds)
    account = Account(
        primary_smtp_address=EMAIL,
        credentials=creds,
        autodiscover=False,   # EXCHANGE_SERVER가 확실하면 False
        config=config,
        access_type=DELEGATE,
    )

    # 2) 마지막 체크 시각 불러오기
    last_check = load_last_check_time()
    now = datetime.now(timezone.utc)

    # 3) 받은 편지함에서 기간 필터
    qs = account.inbox.filter(datetime_received__gt=last_check,
                              datetime_received__lte=now)

    matched = []

    for item in qs:
        # 메일이 아닌 항목은 스킵
        if not isinstance(item, Message):
            continue

        subject = item.subject or ""
        body = (item.body or "").strip()
        # 수신자 체크 (To, Cc)
        recipients = []
        if item.to_recipients:
            recipients.extend([r.email_address for r in item.to_recipients])
        if item.cc_recipients:
            recipients.extend([r.email_address for r in item.cc_recipients])

        is_to_me = any(EMAIL.lower() in (addr or "").lower() for addr in recipients)

        # 키워드 체크 (제목 + 본문)
        combined_text = (subject + "
" + body).lower()
        has_keyword = any(k.lower() in combined_text for k in KEYWORDS)

        if is_to_me or has_keyword:
            matched.append(item)

    # 4) 결과 알림
    if matched:
        # 간단하게 개수만 알려주고, 제목 몇 개 출력
        msg_lines = []
        for m in matched[:5]:  # 최대 5개만 요약
            msg_lines.append(f"- {m.subject}")

        msg = "
".join(msg_lines)
        notify("메일 알림", f"{len(matched)}개의 메일이 조건에 맞습니다.

{msg}")
    else:
        # 필요 없으면 이 부분은 주석 처리
        # notify("메일 알림", "조건에 맞는 새 메일이 없습니다.")
        pass

    # 5) 마지막 체크 시각 갱신
    save_last_check_time(now)

if __name__ == "__main__":
    main()
```

이 스크립트를 예를 들어 `C:\scripts\check_exchange_mail.py` 같은 곳에 저장합니다.

> ⚠ `EXCHANGE_SERVER`, `USERNAME`, `EMAIL`, `PASSWORD` 는  
> IT팀 / 본인 계정 정보에 맞게 반드시 수정해야 합니다.  
> EWS URL은 보통 IT팀에  
> “EWS 주소(Exchange Web Services URL) 알려주세요”  
> 라고 물어보면 줍니다.

---

## 3. 06:30 / 12:30에 자동 실행 (Windows 작업 스케줄러)

1. **작업 스케줄러 열기**
   - 시작 메뉴 → “작업 스케줄러” 검색

2. **기본 작업 만들기**
   - 이름: `Exchange 메일 키워드 알림`
   - 트리거: `매일`
   - 시간: `06:30`
   - 다 만든 다음, 해당 작업 → 우클릭 → **속성** → “트리거” 탭에서  
     `새로 만들기` 눌러서 `12:30` 트리거 하나 더 추가

3. **동작 설정**
   - 동작: `프로그램 시작`
   - 프로그램/스크립트: `python.exe` 경로  
     예) `C:\Python312\python.exe`
   - 인수 추가:  
     `C:\scripts\check_exchange_mail.py`
   - 시작 위치:  
     `C:\scripts`

4. 필요하면 “가장 높은 권한으로 실행” 체크  
   (Exchange 접속 정책에 따라 다를 수 있습니다)

이렇게 해두면:

- 매일 06:30, 12:30에
- 스크립트가 자동으로
- 받은 편지함에서 새 메일을 검사하고
- 조건 맞으면 Windows 알림을 띄웁니다.

---

## 4. Outlook만 이용해서 비슷하게 하는 방법

만약 Python/스크립트가 부담스럽다면:

- Outlook 규칙 + VBA 스크립트로
  - 메일이 **도착했을 때 즉시** 조건 검사하고
  - 팝업 또는 특정 폴더로 이동/표시

는 가능합니다.  
하지만 “06:30/12:30 한 번에 모아서 알려줘” 같은 **시간 기반 요약**은 Outlook 단독으로는 힘들고, 결국 매크로 + 스케줄러 조합이 필요해서 더 꼬일 수 있어요.

그래서:

> **Exchange라면 → Python + exchangelib + Windows 스케줄러 조합**이  
> 가장 깔끔하고 유지보수도 쉽습니다.

---

## 5. 다음 단계

원하면 제가:

- 스크립트를 **“회사 환경용 템플릿”** 형태로 정리해서,
- 주석과 함께  
  - 어디에 서버 주소 넣고  
  - 어디에 계정 넣고  
  - 키워드/시간대 바꾸는지

까지 더 깔끔하게 정리해 줄 수 있어요.

또, 나중에:

- 알림 대신 **“나에게 요약 메일 다시 보내기”** 버전  
- 로그 파일을 남기는 버전

으로 변형도 가능해요.  

일단 “Exchange라서 불가능한 건가?” 하는 걱정은 안 해도 됩니다.  
충분히 만들 수 있어요 😄